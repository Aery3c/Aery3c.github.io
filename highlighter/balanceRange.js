(()=>{"use strict";var e={d:(t,r)=>{for(var n in r)e.o(r,n)&&!e.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:r[n]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};e.r(t),e.d(t,{moveNode:()=>d,removeNode:()=>f,splitNode:()=>l});var r={};e.r(r),e.d(r,{addClass:()=>E,classesToArray:()=>m,getClass:()=>S,hasClass:()=>O,removeClass:()=>T,rnothtmlwhite:()=>v,stripAndCollapse:()=>b,toggleClass:()=>N});var n={};e.r(n),e.d(n,{findClosestAncestor:()=>w,findSelfOrAncestorWithClass:()=>P,isAncestorOf:()=>j,isOrIsAncestorOf:()=>_});var o={};e.r(o),e.d(o,{getIntersectionRange:()=>I,intersectsRange:()=>M});var i={};e.r(i),e.d(i,{RangeIterator:()=>W,iterateSubtree:()=>$});var a={};e.r(a),e.d(a,{getEffectiveTextNodes:()=>H,getNodes:()=>q});var s={};function c(e){if(!e)return!1;var t=e.nodeType;return t===Node.TEXT_NODE||t===Node.COMMENT_NODE}function u(e){for(var t=0;e=e.previousSibling;)t++;return t}function l(e,t,r){var n,o,i,a=0===r;if(c(t)){var s=u(t);0===r?r=s:r===t.data.length&&(r=s+1),t=t.parentNode}if(i=r,c(o=t)?0===i?o.previousSibling:i!==o.length||o.nextSibling:i>0&&i<o.childNodes.length){(n=t.cloneNode(!1)).hasAttribute("id")&&n.removeAttribute("id");for(var f,h=0;f=t.childNodes[r];)d(f,n,h++);d(n,t.parentNode,u(t)+1)}else if(e!==t){n=t.parentNode;var y=u(t);return a||y++,l(e,n,y)}}function f(e){var t=e.parentNode;return t?t.removeChild(e):null}function d(e,t,r){-1===r&&(r=t.childNodes.length),r===t.childNodes.length?t.appendChild(e):t.insertBefore(e,t.childNodes[r])}function h(e){return function(e){if(Array.isArray(e))return y(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return y(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?y(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function y(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}e.r(s),e.d(s,{getRangesInSelection:()=>G,getSelection:()=>z});var p=!(void 0!==document.createElement("span").classList),g=!(void 0!==document.createElement("span").className),v=/[^\x20\t\r\n\f]+/g;function b(e){return(e.match(v)||[]).join(" ")}function m(e){return Array.isArray(e)?e:"string"==typeof e&&e.match(v)||[]}function N(e,t){var r=m(t);return!(!r.length||e.nodeType!==Node.ELEMENT_NODE||(r.forEach((function(t){p?e.classList.toggle(t):O(e,t)?T(e,t):E(e,t)})),0))}function S(e){return e.nodeType!==Node.ELEMENT_NODE?"":g?e.className:e.getAttribute("class")||""}function O(e,t){return e.nodeType===Node.ELEMENT_NODE&&(p?e.classList.contains(t):m(S(e)).indexOf(t)>-1)}function E(e,t){var r,n,o,i,a=m(t);a.length&&e.nodeType===Node.ELEMENT_NODE&&(p?(i=e.classList).add.apply(i,h(a)):(r=S(e),n=" "+b(r)+" ",a.forEach((function(e){n.indexOf(" "+e+" ")<0&&(n+=e+" ")})),r!==(o=b(n))&&(g?e.className=o:e.setAttribute("class",o))))}function T(e,t){var r,n,o,i,a=m(t),s=e.nodeType===Node.ELEMENT_NODE;if(arguments.length<2&&s)return e.removeAttribute("class");a.length&&s&&(p?(i=e.classList).remove.apply(i,h(a)):(r=S(e),n=" "+b(r)+" ",a.forEach((function(e){for(;n.indexOf(" "+e+" ")>-1;)n=n.replace(" "+e+" "," ")})),r!==(o=b(n))&&(g?e.className=o:e.setAttribute("class",o))))}function w(e,t){for(var r;t;){if((r=t.parentNode)===e)return t;t=r}return null}function j(e,t,r){for(var n=r?t:t.parentNode;n;){if(n===e)return!0;n=n.parentNode}return!1}function _(e,t){return j(e,t,!0)}function P(e,t){for(;e;){if(O(e,t))return e;e=e.parentNode}return null}function R(e){return e.nodeType===Node.ELEMENT_NODE?e.childNodes.length:c(e)?e.length:0}function C(e){return C="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},C(e)}function A(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function D(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?A(Object(r),!0).forEach((function(t){x(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):A(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function x(e,t,r){return(t=function(e){var t=function(e,t){if("object"!==C(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!==C(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===C(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function k(e){var t,r,n=arguments.length<=1?void 0:arguments[1],o=arguments.length<=2?void 0:arguments[2],i=R(n);switch(arguments.length<=1?0:arguments.length-1){case 2:t=n,r=i;break;case 3:t=arguments.length<=3?void 0:arguments[3],r=o;break;case 4:t=arguments.length<=3?void 0:arguments[3],r=arguments.length<=4?void 0:arguments[4]}e.setStart(n,o),e.setEnd(t,r)}function I(e,t){if(M(e,t)){var r=e.cloneRange();return-1===r.compareBoundaryPoints(t.START_TO_START,t)&&r.setStart(t.startContainer,t.startOffset),1===r.compareBoundaryPoints(t.END_TO_END,t)&&r.setEnd(t.endContainer,t.endOffset),r}return null}function M(e,t){var r=e.compareBoundaryPoints(t.END_TO_START,t),n=e.compareBoundaryPoints(t.START_TO_END,t);return r<0&&n>0}function L(e){return L="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},L(e)}function B(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,F(n.key),n)}}function X(e,t,r){return(t=F(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function F(e){var t=function(e,t){if("object"!==L(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!==L(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===L(t)?t:String(t)}D(D(D(D({},t),r),n),{},{isCharacterDataNode:c,getNodeIndex:u,getNodeLength:R,getSelection});var W=function(){function e(t){var r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),X(this,"_current",null),X(this,"_end",null),X(this,"_next",null),this.range=t,this.clonePartiallySelectedTextNodes=r,this.range.collapsed||(this.root=this.range.commonAncestorContainer,this.sc=this.range.startContainer,this.so=this.range.startOffset,this.ec=this.range.endContainer,this.eo=this.range.endOffset,this.sc===this.ec&&c(this.sc)?this._next=this._end=this.sc:(this._next=this.sc!==this.root||c(this.sc)?w(this.root,this.sc):this.sc.childNodes[this.so],this._end=this.ec!==this.root||c(this.ec)?w(this.root,this.ec):this.ec.childNodes[this.eo-1]))}var t,r;return t=e,(r=[{key:"next",value:function(){var e=this._current=this._next;return this._next=null!=this._current&&this._current!==this._end?this._current.nextSibling:null,c(e)&&this.clonePartiallySelectedTextNodes&&(e===this.ec&&(e=e.cloneNode(!0)).deleteData(this.eo,e.length-this.eo),e===this.sc&&(e=e.cloneNode(!0)).deleteData(0,this.so)),e}},{key:"isPartiallySelectedSubtree",value:function(){return!c(this._current)&&(_(this._current,this.sc)||_(this._current,this.ec))}},{key:"getSubtreeIterator",value:function(){var t=document.createRange(),r=this._current,n=r,o=0,i=r,a=R(r);return r&&(_(r,this.sc)&&(n=this.sc,o=this.so),_(r,this.ec)&&(i=this.ec,a=this.eo)),k(t,n,o,i,a),new e(t,this.clonePartiallySelectedTextNodes)}}])&&B(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function $(e,t){for(var r;r=e.next();)if(e.isPartiallySelectedSubtree())$(e.getSubtreeIterator(),t);else for(var n=document.createNodeIterator(r);r=n.nextNode();)t(r)}function q(e,t,r){var n,o=[];return t&&t.length&&(n=new RegExp("(".concat(t.join("|"),")$"))),$(new W(e,!1),(function(e){n&&!n.test(e.nodeType.toString())||("function"!=typeof r||r(e))&&o.push(e)})),o}function H(e){for(var t,r=q(e,[Node.TEXT_NODE]),n=0,o=r.length;(t=r[n])&&!U(e,t);)++n;for(;(t=r[o-1])&&!U(e,t);)--o;return r.slice(n,o)}function U(e,t){var r=document.createRange();r.selectNodeContents(t);var n=I(r,e);return""!==(n?n.toString():"")}function z(e){return e instanceof Selection?e:window.getSelection()}function G(e){for(var t=[],r=0;r<e.rangeCount;++r)t.push(e.getRangeAt(r));return t}function J(e){return J="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},J(e)}function K(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Q(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?K(Object(r),!0).forEach((function(t){V(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):K(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function V(e,t,r){return(t=function(e){var t=function(e,t){if("object"!==J(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!==J(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===J(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const Y=Q(Q(Q(Q(Q({},o),a),i),s),{},{splitRangeBoundaries:function(e){var t=[e.startContainer,e.startOffset,e.endContainer,e.endOffset],r=t[0],n=t[1],o=t[2],i=t[3],a=r===o;c(o)&&i>0&&i<o.length&&o.splitText(i),c(r)&&n>0&&n<r.length&&(r=r.splitText(n),a?(i-=n,o=r):o===r.parentNode&&i<=u(r)&&i++,n=0)},setRange:k});function Z(e){var t=e?"nextSibling":"previousSibling",r=e?"firstChild":"lastChild";return function(e,n,o){var i=e[t],a=e.parentNode;if(i&&i.nodeType===Node.TEXT_NODE)return i;if(n&&(i=a[t])&&i.nodeType===Node.ELEMENT_NODE){if(o&&!o(i))return null;var s=i[r];if(s&&s.nodeType===Node.TEXT_NODE)return s}return null}}function ee(e){return ee="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ee(e)}function te(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==ee(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!==ee(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(n.key),"symbol"===ee(o)?o:String(o)),n)}var o}Z(!1),Z(!0),Function.prototype.apply,Function.prototype.call;var re=function(){function e(t,r,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.start=t,this.end=r,this.referenceNode=n,this.isCollapsed=this.start===this.end}var t,r,n;return t=e,n=[{key:"fromRange",value:function(t,r){var n=t.cloneRange();n.selectNodeContents(r);var o=Y.getIntersectionRange(n,t),i=0,a=0;return o&&(n.setEnd(o.startContainer,o.startOffset),a=(i=n.toString().length)+o.toString().length),new e(i,a,r)}},{key:"fromSelection",value:function(t,r){var n=[];return Y.getRangesInSelection(t).forEach((function(t){n.push(e.fromRange(t,r))})),n}}],(r=[{key:"_createRelativeCharacterRange",value:function(t){return t.referenceNode!==this.referenceNode?e.fromRange(t.toRange(),this.referenceNode):t}},{key:"isEqual",value:function(e){return e=this._createRelativeCharacterRange(e),this.start===e.start&&this.end===e.end}},{key:"isIntersects",value:function(e){return e=this._createRelativeCharacterRange(e),this.start<e.end&&this.end>e.start}},{key:"isAdjoin",value:function(e){return e=this._createRelativeCharacterRange(e),this.start===e.end||this.end===e.start}},{key:"union",value:function(t){return t=this._createRelativeCharacterRange(t),this.isIntersects(t)||this.isAdjoin(t)?new e(Math.min(this.start,t.start),Math.max(this.end,t.end),this.referenceNode):null}},{key:"intersection",value:function(t){return t=this._createRelativeCharacterRange(t),this.isIntersects(t)?new e(Math.max(this.start,t.start),Math.min(this.end,t.end),this.referenceNode):null}},{key:"complementarySet",value:function(t){var r=[];return t=this._createRelativeCharacterRange(t),this.start<t.start&&r.push(new e(this.start,t.start,this.referenceNode)),this.end>t.end&&r.push(new e(t.end,this.end,this.referenceNode)),r}},{key:"toRange",value:function(){var e=document.createRange(),t=this.start,r=this.end;e.setStart(this.referenceNode,0),e.collapse(!0);for(var n,o,i=document.createNodeIterator(this.referenceNode,NodeFilter.SHOW_TEXT),a=0,s=!1,c=!1;!c&&(n=i.nextNode())&&n;)o=a+n.length,!s&&t>=a&&t<=o&&(e.setStart(n,t-a),s=!0),r>=a&&r<=o&&(e.setEnd(n,r-a),c=!0),a=o;return e}}])&&te(t.prototype,r),n&&te(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}(),ne=document.getElementById("p"),oe=document.getElementById("span"),ie=document.body;if(ne&&oe&&ie){var ae=new re(0,9,ne),se=new re(0,9,oe);console.log(re.fromRange(ae.toRange(),ie)),console.log(re.fromRange(se.toRange(),ie))}})();
//# sourceMappingURL=balanceRange.js.map